---
- name:
  hosts: all
  vars:
  connection: httpapi
  gather_facts: false
  tasks:
    - name: Create
      fwebos_server_policy:
       action: add
       vdom: root
       retry_on_connect_failure: disable
       protocol: HTTP
       client_certificate_forwarding: disable
       client_real_ip: disable
       urlcert_hlen: 32
       hsts_max_age: 15552000
       tls13_custom_cipher: TLS_AES_256_GCM_SHA384
       urlcert: disable
       syncookie: disable
       service: HTTP
       hsts_preload: disable
       sni_strict: disable
       client_certificate_forwarding_cert_header: X-Client-Cert
       retry_times_on_connect_failure: 3
       ssl_cipher: medium
       traffic_mirror_type: client-side
       multi_certificate: enable
       hsts_header: disable
       monitor_mode: disable
       deployment_mode: server-pool
       tls_v13: disable
       tls_v10: enable
       tls_v11: enable
       proxy_protocol: disable
       vserver: test4
       real_ip_addr: 
       ssl_custom_cipher: ECDHE-ECDSA-AES256-GCM-SHA384 ECDHE-RSA-AES256-GCM-SHA384 ECDHE-ECDSA-CHACHA20-POLY1305 ECDHE-RSA-CHACHA20-POLY1305 ECDHE-ECDSA-AES128-GCM-SHA256 ECDHE-RSA-AES128-GCM-SHA256 ECDHE-ECDSA-AES256-SHA384 ECDHE-RSA-AES256-SHA384 ECDHE-ECDSA-AES128-SHA256 ECDHE-RSA-AES128-SHA256 ECDHE-ECDSA-AES256-SHA ECDHE-RSA-AES256-SHA ECDHE-ECDSA-AES128-SHA ECDHE-RSA-AES128-SHA AES256-GCM-SHA384 AES128-GCM-SHA256 AES256-SHA256 AES128-SHA256
       retry_on_cache_size: 512
       http_to_https: disable
       hsts_include_subdomains: disable
       half_open_threshold: 8192
       retry_on_http_layer: disable
       traffic_mirror: disable
       client_certificate_forwarding_sub_header: X-Client-DN
       sni: disable
       ssl: enable
       web_cache: disable
       ssl_noreg: enable
       retry_on_http_response_codes: 404 408 500 501 502 503 504
       prefer_current_session: disable
       retry_times_on_http_layer: 3
       case_sensitive: disable
       name: test4
       replacemsg: Predefined
       server_pool: test4
       retry_on: disable
       tls_v12: enable
       https_service: HTTPS
       http2: disable
       certificate_type: disable
       http2_custom_cipher: ECDHE-ECDSA-AES256-GCM-SHA384 DHE-DSS-AES128-GCM-SHA256 DHE-RSA-AES128-GCM-SHA256 ECDHE-RSA-AES256-GCM-SHA384
       web_protection_profile: Inline Standard Protection
       certificate_group: test
       allow_hosts: test.com
       intermediate_certificate_group: test
       comment: test111
       tlog: disable
       redirect_naked_domain: enable
       http3_service: enable
       chunk_encoding: enable

    - name: edit
      fwebos_server_policy:
       action: edit 
       vdom: root
       retry_on_connect_failure: disable
       protocol: HTTP
       client_certificate_forwarding: disable
       client_real_ip: disable
       urlcert_hlen: 32
       hsts_max_age: 15552000
       tls13_custom_cipher: TLS_AES_256_GCM_SHA384
       urlcert: disable
       syncookie: disable
       service: HTTP
       hsts_preload: disable
       sni_strict: disable
       client_certificate_forwarding_cert_header: X-Client-Cert
       retry_times_on_connect_failure: 3
       ssl_cipher: medium
       traffic_mirror_type: client-side
       multi_certificate: disable
       hsts_header: disable
       monitor_mode: disable
       deployment_mode: server-pool
       tls_v13: disable
       tls_v10: enable
       tls_v11: enable
       proxy_protocol: disable
       vserver: test4
       real_ip_addr: 
       ssl_custom_cipher: ECDHE-ECDSA-AES256-GCM-SHA384 ECDHE-RSA-AES256-GCM-SHA384 ECDHE-ECDSA-CHACHA20-POLY1305 ECDHE-RSA-CHACHA20-POLY1305 ECDHE-ECDSA-AES128-GCM-SHA256 ECDHE-RSA-AES128-GCM-SHA256 ECDHE-ECDSA-AES256-SHA384 ECDHE-RSA-AES256-SHA384 ECDHE-ECDSA-AES128-SHA256 ECDHE-RSA-AES128-SHA256 ECDHE-ECDSA-AES256-SHA ECDHE-RSA-AES256-SHA ECDHE-ECDSA-AES128-SHA ECDHE-RSA-AES128-SHA AES256-GCM-SHA384 AES128-GCM-SHA256 AES256-SHA256 AES128-SHA256
       retry_on_cache_size: 512
       http_to_https: disable
       hsts_include_subdomains: disable
       half_open_threshold: 8192
       retry_on_http_layer: disable
       traffic_mirror: disable
       client_certificate_forwarding_sub_header: X-Client-DN
       sni: disable
       ssl: enable
       web_cache: disable
       ssl_noreg: enable
       retry_on_http_response_codes: 404 408 500 501 502 503 504
       prefer_current_session: disable
       retry_times_on_http_layer: 3
       case_sensitive: disable
       name: test4
       replacemsg: Predefined
       server_pool: test4
       retry_on: disable
       tls_v12: enable
       https_service: HTTPS
       http2: disable
       certificate_type: enable
       http2_custom_cipher: ECDHE-ECDSA-AES256-GCM-SHA384 DHE-DSS-AES128-GCM-SHA256 DHE-RSA-AES128-GCM-SHA256 ECDHE-RSA-AES256-GCM-SHA384
       web_protection_profile: Inline Standard Protection
       lets_certificate: test
       allow_hosts: test.com
       intermediate_certificate_group: test
       comment: test111
       tlog: enable
       chunk_encoding: enable

    - name: edit
      fwebos_server_policy:
       action: edit 
       vdom: root
       retry_on_connect_failure: disable
       protocol: HTTP
       client_certificate_forwarding: disable
       client_real_ip: disable
       urlcert_hlen: 32
       hsts_max_age: 15552000
       tls13_custom_cipher: TLS_AES_256_GCM_SHA384
       urlcert: disable
       syncookie: disable
       service: HTTP
       hsts_preload: disable
       sni_strict: disable
       client_certificate_forwarding_cert_header: X-Client-Cert
       retry_times_on_connect_failure: 3
       ssl_cipher: medium
       traffic_mirror_type: client-side
       multi_certificate: disable
       hsts_header: disable
       monitor_mode: disable
       deployment_mode: server-pool
       tls_v13: disable
       tls_v10: enable
       tls_v11: enable
       proxy_protocol: disable
       vserver: test4
       real_ip_addr: 
       ssl_custom_cipher: ECDHE-ECDSA-AES256-GCM-SHA384 ECDHE-RSA-AES256-GCM-SHA384 ECDHE-ECDSA-CHACHA20-POLY1305 ECDHE-RSA-CHACHA20-POLY1305 ECDHE-ECDSA-AES128-GCM-SHA256 ECDHE-RSA-AES128-GCM-SHA256 ECDHE-ECDSA-AES256-SHA384 ECDHE-RSA-AES256-SHA384 ECDHE-ECDSA-AES128-SHA256 ECDHE-RSA-AES128-SHA256 ECDHE-ECDSA-AES256-SHA ECDHE-RSA-AES256-SHA ECDHE-ECDSA-AES128-SHA ECDHE-RSA-AES128-SHA AES256-GCM-SHA384 AES128-GCM-SHA256 AES256-SHA256 AES128-SHA256
       retry_on_cache_size: 512
       http_to_https: disable
       hsts_include_subdomains: disable
       half_open_threshold: 8192
       retry_on_http_layer: disable
       traffic_mirror: disable
       client_certificate_forwarding_sub_header: X-Client-DN
       sni: disable
       ssl: enable
       web_cache: disable
       ssl_noreg: enable
       retry_on_http_response_codes: 404 408 500 501 502 503 504
       prefer_current_session: disable
       retry_times_on_http_layer: 3
       case_sensitive: disable
       name: test4
       replacemsg: Predefined
       server_pool: test4
       retry_on: disable
       tls_v12: enable
       https_service: HTTPS
       http2: disable
       certificate_type: disable 
       http2_custom_cipher: ECDHE-ECDSA-AES256-GCM-SHA384 DHE-DSS-AES128-GCM-SHA256 DHE-RSA-AES128-GCM-SHA256 ECDHE-RSA-AES256-GCM-SHA384
       web_protection_profile: Inline Standard Protection
       certificate: aaa1
       allow_hosts: test.com
       intermediate_certificate_group: test
       comment: test111
       tlog: enable
       chunk_encoding: enable

    - name: delete 
      fwebos_server_policy:
       action: delete 
       name: test4 
       vdom: root

    - name: Create
      fwebos_server_policy:
        action: add
        protocol: HTTP
        name: P2
        deployment_mode: server-pool
        client_real_ip: disable
        ssl: enable
        http2: disable
        certificate_type: disable
        multi_certificate: disable
        http_to_https: disable
        traffic_mirror: disable
        traffic_mirror_type: client-side
        monitor_mode: disable
        syncookie: disable
        half_open_threshold: 8192
        case_sensitive: disable
        proxy_protocol: disable
        retry_on: disable
        retry_on_cache_size: 512
        retry_on_connect_failure: disable
        retry_times_on_connect_failure: 3
        retry_on_http_layer: disable
        retry_times_on_http_layer: 3
        retry_on_http_response_codes: 404 408 500 501 502 503 504
        web_cache: disable
        prefer_current_session: disable
        tlog: disable
        redirect_naked_domain: enable
        tls_v10: enable
        tls_v11: enable
        tls_v12: enable
        tls_v13: enable
        ssl_cipher: medium
        ssl_custom_cipher: ECDHE-ECDSA-AES256-GCM-SHA384 ECDHE-RSA-AES256-GCM-SHA384 ECDHE-ECDSA-CHACHA20-POLY1305 ECDHE-RSA-CHACHA20-POLY1305 ECDHE-ECDSA-AES128-GCM-SHA256 ECDHE-RSA-AES128-GCM-SHA256 ECDHE-ECDSA-AES256-SHA384 ECDHE-RSA-AES256-SHA384 ECDHE-ECDSA-AES128-SHA256 ECDHE-RSA-AES128-SHA256 ECDHE-ECDSA-AES256-SHA ECDHE-RSA-AES256-SHA ECDHE-ECDSA-AES128-SHA ECDHE-RSA-AES128-SHA AES256-GCM-SHA384 AES128-GCM-SHA256 AES256-SHA256 AES128-SHA256
        tls13_custom_cipher: TLS_AES_256_GCM_SHA384
        ssl_noreg: enable
        sni: disable
        sni_strict: disable
        urlcert: disable
        urlcert_hlen: 32
        client_certificate_forwarding: disable
        client_certificate_forwarding_sub_header: X-Client-DN
        client_certificate_forwarding_cert_header: X-Client-Cert
        hsts_header: disable
        hsts_max_age: 15552000
        hsts_include_subdomains: disable
        hsts_preload: disable
        use_ciphers_group: disable
        http3_service: HTTP3
        vserver: vs1
        server_pool: sp2
        service: HTTP
        https_service: HTTPS
        replacemsg: Predefined